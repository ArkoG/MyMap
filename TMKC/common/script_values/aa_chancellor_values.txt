# Calculated max opinion
chancellor_foreign_affairs_opinion_max = {
	add = chancellor_foreign_affairs_opinion_base
	# Add bonus from Clerical Justification:
	if = {
		limit = {
			scope:councillor_liege = { has_perk = adaptive_traditions_perk }
		}
		add = chancellor_foreign_affairs_opinion_max_perk_bonus_modifier
	}
	# Add bonus from Bureaucrats
	if = {
		limit = {
			councillor_liege_has_erudition_legacy_5_perk = yes
		}
		add = chancellor_foreign_affairs_opinion_max_erudition_modifier
	}
	# Add bonus from Family Business
	if = {
		limit = {
			councillor_liege_has_family_business_bonus = yes
		}
		add = chancellor_foreign_affairs_opinion_max_family_business_modifier
	}
	# Add bonus from trait chancellor_1
	if = {
		limit = {
			has_trait = chancellor_1
		}
		add = chancellor_task_chancellor_1_modifier
	}
	# Add bonus from trait chancellor_2
	else_if = {
		limit = {
			has_trait = chancellor_2
		}
		add = chancellor_task_chancellor_2_modifier
	}
	# Add bonus from trait chancellor_3
	else_if = {
		limit = {
			has_trait = chancellor_3
		}
		
		add = chancellor_task_chancellor_3_modifier
	}
}

chancellor_domestic_affairs_opinion_max = {
	add = chancellor_domestic_affairs_opinion_base
	if = {
		limit = {
			scope:councillor_liege = { has_perk = chains_of_loyalty_perk }
		}
		add = chancellor_domestic_affairs_opinion_chains_of_loyalty_bonus
	}
	if = {
		limit = {
			councillor_liege_has_erudition_legacy_5_perk = yes
		}
		add = chancellor_domestic_affairs_opinion_erudition_bonus
	}
	if = {
		limit = {
			councillor_liege_has_family_business_bonus = yes
		}
		add = chancellor_domestic_affairs_opinion_family_business_bonus
	}
	# Add bonus from trait chancellor_1
	if = {
		limit = {
			has_trait = chancellor_1
		}
		add = chancellor_task_chancellor_1_modifier
	}
	# Add bonus from trait chancellor_2
	else_if = {
		limit = {
			has_trait = chancellor_2
		}
		add = chancellor_task_chancellor_2_modifier
	}
	# Add bonus from trait chancellor_3
	else_if = {
		limit = {
			has_trait = chancellor_3
		}
		add = chancellor_task_chancellor_3_modifier
	}
	divide = 2
}

# Final calculation (used for tooltips only)
chancellor_foreign_affairs_prestige_calculation = {
	add = {
		value = chancellor_foreign_affairs_prestige_gain_base
		desc = "Base value"
	}
	add = {
		value = chancellor_foreign_affairs_prestige_gain_perk_bonus_scale
		desc = "Perk bonus"
	}
	add = {
		value = chancellor_foreign_affairs_prestige_gain_erudition_modifier
		desc = "Legacy bonus"
	}
	add = {
		value = chancellor_foreign_affairs_prestige_gain_family_business_modifier
		desc =  FAMILY_BUSINESS_BONUS_VALUE
	}
	add = {
		value = chancellor_foreign_affairs_prestige_gain_chancellor_modifier
		desc = "Chancellor trait bonus"
	}
}

# ========================= New value ===============================================

chancellor_task_chancellor_1_value = 0.05
chancellor_task_chancellor_2_value = 0.10
chancellor_task_chancellor_3_value = 0.15

chancellor_task_chancellor_1_modifier = {
	add = chancellor_foreign_affairs_opinion_base
	multiply = chancellor_task_chancellor_1_value
}
chancellor_integrate_title_chancellor_1_bonus = {
	add = chancellor_integrate_title_progress_gain
	multiply = chancellor_task_chancellor_1_value
}

chancellor_task_chancellor_2_modifier = {
	add = chancellor_foreign_affairs_opinion_base
	multiply = chancellor_task_chancellor_2_value
}
chancellor_integrate_title_chancellor_2_bonus = {
	add = chancellor_integrate_title_progress_gain
	multiply = chancellor_task_chancellor_2_value
}

chancellor_task_chancellor_3_modifier = {
	add = chancellor_foreign_affairs_opinion_base
	multiply = chancellor_task_chancellor_3_value
}
chancellor_integrate_title_chancellor_3_bonus = {
	add = chancellor_integrate_title_progress_gain
	multiply = chancellor_task_chancellor_3_value
}


# chancellor bonus
chancellor_foreign_affairs_prestige_gain_chancellor_modifier = {
	if = {
		limit = {
			has_trait = lifestyle_chancellor
		}
		add = chancellor_foreign_affairs_prestige_gain_base
		multiply = {
			# Add bonus from trait chancellor_1
			if = {
				limit = {
					has_trait = chancellor_1
				}
				add = chancellor_task_chancellor_1_value
			}
			# Add bonus from trait chancellor_2
			else_if = {
				limit = {
					has_trait = chancellor_2
				}
				add = chancellor_task_chancellor_2_value
			}
			# Add bonus from trait chancellor_3
			else_if = {
				limit = {
					has_trait = chancellor_3
				}
				add = chancellor_task_chancellor_3_value
			}
		}
	}
}